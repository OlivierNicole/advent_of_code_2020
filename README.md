Disclaimer: this is quick and dirty code.
